<%= form_with(model: order, local: true) do |form| %>
  <% if order.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(order.errors.count, "error") %> prohibited this order from being saved:</h2>

      <ul>
        <% order.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= form.label :name %>
    <%= form.text_field :name, size: 40 %>
  </div>

  <div class="field">
    <%= form.label :address %>
    <%= form.text_area :address, rows: 3, cols: 40 %>
  </div>

  <div class="field">
    <%= form.label :email %>
    <%= form.email_field :email, size: 40 %>
  </div>

 <div id="pay-type-component"></div>

  <%= fields_for(:payment) do |p| %>
    <div class="row col-md-12">
      <div class="form-group col-md-4 no-left-padding">
        <%= p.label :card_number, 'Card Number', data: { stripe: 'label'} %>
        <%= p.text_field :card_number, class: "form-control", required: true, data: { stripe: 'number' } %>
      </div>
      <div class="form-group col-md-2">
        <%= p.label :card_cvv, 'Card CVC', data: { stripe: 'label'} %>
        <%= p.text_field :card_cvc, class: "form-control", required: true, data: { stripe: 'number' } %>
      </div>
    
      <div class="form-group col-md-6">
        <div class="col-md-12">
          <%= p.label :card_expires, "Card Expires", data: { stripe: 'label' } %>
        </div>
        <div class="col-md-3">
          <%= p.select :card_expires_month, options_for_select(Payment.month_options), 
                        { include_blank: 'Month'}, 
                        'data-stripe' => 'exp-month', 
                        class: 'form-control', 
                        required: true 
          %>
        </div>
        <div class="col-md-3">
          <%= p.select :card_expires_year, options_for_select(Payment.year_options.push), 
                        { include_blank: 'Year'},
                        class: 'form-control',
                        data: { stripe: 'exp-year' },
                        required: true 
          %> 
        </div>
      </div>
    </div>
  <% end %>

  <div class="actions">
    <%= form.submit 'Place Order' %>
  </div>
<% end %>
